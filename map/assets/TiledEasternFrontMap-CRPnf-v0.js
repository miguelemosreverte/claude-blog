const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/live-provider-iPc-Gwsg.js","assets/index-Cpi14mRT.js","assets/index-BpC6VBbP.css"])))=>i.map(i=>d[i]);
import{r as z,_ as Cr,j as P}from"./index-Cpi14mRT.js";import{L as An}from"./land-mask-Bt4oIyE1.js";function Ln(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}function kn(c){if(Object.prototype.hasOwnProperty.call(c,"__esModule"))return c;var d=c.default;if(typeof d=="function"){var h=function b(){var w=!1;try{w=this instanceof b}catch{}return w?Reflect.construct(d,arguments,this.constructor):d.apply(this,arguments)};h.prototype=d.prototype}else h={};return Object.defineProperty(h,"__esModule",{value:!0}),Object.keys(c).forEach(function(b){var w=Object.getOwnPropertyDescriptor(c,b);Object.defineProperty(h,b,w.get?w:{enumerable:!0,get:function(){return c[b]}})}),h}var rr={exports:{}};const jn={},Tn=Object.freeze(Object.defineProperty({__proto__:null,default:jn},Symbol.toStringTag,{value:"Module"})),Pr=kn(Tn);var Dr;function On(){return Dr||(Dr=1,(function(c,d){var h=void 0,b=function(w){return h||(h=new Promise(function(M,B){var N=typeof w<"u"?w:{},H=N.onAbort;N.onAbort=function(t){B(new Error(t)),H&&H(t)},N.postRun=N.postRun||[],N.postRun.push(function(){M(N)}),c=void 0;var i;i||=typeof N<"u"?N:{};var X=typeof window=="object",U=typeof WorkerGlobalScope<"u",et=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";i.onRuntimeInitialized=function(){function t(s,u){switch(typeof u){case"boolean":Sn(s,u?1:0);break;case"number":Mn(s,u);break;case"string":En(s,u,-1,-1);break;case"object":if(u===null)jr(s);else if(u.length!=null){var y=Pe(u,Ce);qn(s,y,u.length,-1),De(y)}else Ne(s,"Wrong API use : tried to return a value of an unknown type ("+u+").",-1);break;default:jr(s)}}function e(s,u){for(var y=[],E=0;E<s;E+=1){var L=C(u+4*E,"i32"),W=yn(L);if(W===1||W===2)L=xn(L);else if(W===3)L=gn(L);else if(W===4){W=L,L=_n(W),W=vn(W);for(var gt=new Uint8Array(L),_t=0;_t<L;_t+=1)gt[_t]=J[W+_t];L=gt}else L=null;y.push(L)}return y}function r(s,u){this.Qa=s,this.db=u,this.Oa=1,this.lb=[]}function n(s,u){if(this.db=u,u=Ct(s)+1,this.eb=Je(u),this.eb===null)throw Error("Unable to allocate memory for the SQL string");tt(s,D,this.eb,u),this.kb=this.eb,this.Za=this.pb=null}function o(s){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),s!=null){var u=this.filename,y="/",E=u;if(y&&(y=typeof y=="string"?y:Pt(y),E=u?Kt(y+"/"+u):y),u=Xt(!0,!0),E=Qr(E,u),s){if(typeof s=="string"){y=Array(s.length);for(var L=0,W=s.length;L<W;++L)y[L]=s.charCodeAt(L);s=y}je(E,u|146),y=re(E,577),vr(y,s,0,s.length,0),Qe(y),je(E,u)}}this.handleError(v(this.filename,a)),this.db=C(a,"i32"),Or(this.db),this.fb={},this.Sa={}}var a=Bt(4),l=i.cwrap,v=l("sqlite3_open","number",["string","number"]),O=l("sqlite3_close_v2","number",["number"]),k=l("sqlite3_exec","number",["number","string","number","number","number"]),Z=l("sqlite3_changes","number",["number"]),dt=l("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Sr=l("sqlite3_sql","string",["number"]),tn=l("sqlite3_normalized_sql","string",["number"]),Rr=l("sqlite3_prepare_v2","number",["number","number","number","number","number"]),en=l("sqlite3_bind_text","number",["number","number","number","number","number"]),Ar=l("sqlite3_bind_blob","number",["number","number","number","number","number"]),rn=l("sqlite3_bind_double","number",["number","number","number"]),nn=l("sqlite3_bind_int","number",["number","number","number"]),on=l("sqlite3_bind_parameter_index","number",["number","string"]),sn=l("sqlite3_step","number",["number"]),an=l("sqlite3_errmsg","string",["number"]),ln=l("sqlite3_column_count","number",["number"]),un=l("sqlite3_data_count","number",["number"]),cn=l("sqlite3_column_double","number",["number","number"]),Lr=l("sqlite3_column_text","string",["number","number"]),fn=l("sqlite3_column_blob","number",["number","number"]),hn=l("sqlite3_column_bytes","number",["number","number"]),dn=l("sqlite3_column_type","number",["number","number"]),mn=l("sqlite3_column_name","string",["number","number"]),pn=l("sqlite3_reset","number",["number"]),bn=l("sqlite3_clear_bindings","number",["number"]),wn=l("sqlite3_finalize","number",["number"]),kr=l("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),yn=l("sqlite3_value_type","number",["number"]),_n=l("sqlite3_value_bytes","number",["number"]),gn=l("sqlite3_value_text","string",["number"]),vn=l("sqlite3_value_blob","number",["number"]),xn=l("sqlite3_value_double","number",["number"]),Mn=l("sqlite3_result_double","",["number","number"]),jr=l("sqlite3_result_null","",["number"]),En=l("sqlite3_result_text","",["number","string","number","number"]),qn=l("sqlite3_result_blob","",["number","number","number","number"]),Sn=l("sqlite3_result_int","",["number","number"]),Ne=l("sqlite3_result_error","",["number","string","number"]),Tr=l("sqlite3_aggregate_context","number",["number","number"]),Or=l("RegisterExtensionFunctions","number",["number"]),zr=l("sqlite3_update_hook","number",["number","number","number"]);r.prototype.bind=function(s){if(!this.Qa)throw"Statement closed";return this.reset(),Array.isArray(s)?this.Cb(s):s!=null&&typeof s=="object"?this.Db(s):!0},r.prototype.step=function(){if(!this.Qa)throw"Statement closed";this.Oa=1;var s=sn(this.Qa);switch(s){case 100:return!0;case 101:return!1;default:throw this.db.handleError(s)}},r.prototype.wb=function(s){return s==null&&(s=this.Oa,this.Oa+=1),cn(this.Qa,s)},r.prototype.Gb=function(s){if(s==null&&(s=this.Oa,this.Oa+=1),s=Lr(this.Qa,s),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(s)},r.prototype.Hb=function(s){return s==null&&(s=this.Oa,this.Oa+=1),Lr(this.Qa,s)},r.prototype.getBlob=function(s){s==null&&(s=this.Oa,this.Oa+=1);var u=hn(this.Qa,s);s=fn(this.Qa,s);for(var y=new Uint8Array(u),E=0;E<u;E+=1)y[E]=J[s+E];return y},r.prototype.get=function(s,u){u=u||{},s!=null&&this.bind(s)&&this.step(),s=[];for(var y=un(this.Qa),E=0;E<y;E+=1)switch(dn(this.Qa,E)){case 1:var L=u.useBigInt?this.Gb(E):this.wb(E);s.push(L);break;case 2:s.push(this.wb(E));break;case 3:s.push(this.Hb(E));break;case 4:s.push(this.getBlob(E));break;default:s.push(null)}return s},r.prototype.getColumnNames=function(){for(var s=[],u=ln(this.Qa),y=0;y<u;y+=1)s.push(mn(this.Qa,y));return s},r.prototype.getAsObject=function(s,u){s=this.get(s,u),u=this.getColumnNames();for(var y={},E=0;E<u.length;E+=1)y[u[E]]=s[E];return y},r.prototype.getSQL=function(){return Sr(this.Qa)},r.prototype.getNormalizedSQL=function(){return tn(this.Qa)},r.prototype.run=function(s){return s!=null&&this.bind(s),this.step(),this.reset()},r.prototype.sb=function(s,u){u==null&&(u=this.Oa,this.Oa+=1),s=fe(s);var y=Pe(s,Ce);this.lb.push(y),this.db.handleError(en(this.Qa,u,y,s.length-1,0))},r.prototype.Bb=function(s,u){u==null&&(u=this.Oa,this.Oa+=1);var y=Pe(s,Ce);this.lb.push(y),this.db.handleError(Ar(this.Qa,u,y,s.length,0))},r.prototype.rb=function(s,u){u==null&&(u=this.Oa,this.Oa+=1),this.db.handleError((s===(s|0)?nn:rn)(this.Qa,u,s))},r.prototype.Eb=function(s){s==null&&(s=this.Oa,this.Oa+=1),Ar(this.Qa,s,0,0,0)},r.prototype.tb=function(s,u){switch(u==null&&(u=this.Oa,this.Oa+=1),typeof s){case"string":this.sb(s,u);return;case"number":this.rb(s,u);return;case"bigint":this.sb(s.toString(),u);return;case"boolean":this.rb(s+0,u);return;case"object":if(s===null){this.Eb(u);return}if(s.length!=null){this.Bb(s,u);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+s+")."},r.prototype.Db=function(s){var u=this;return Object.keys(s).forEach(function(y){var E=on(u.Qa,y);E!==0&&u.tb(s[y],E)}),!0},r.prototype.Cb=function(s){for(var u=0;u<s.length;u+=1)this.tb(s[u],u+1);return!0},r.prototype.reset=function(){return this.freemem(),bn(this.Qa)===0&&pn(this.Qa)===0},r.prototype.freemem=function(){for(var s;(s=this.lb.pop())!==void 0;)De(s)},r.prototype.free=function(){this.freemem();var s=wn(this.Qa)===0;return delete this.db.fb[this.Qa],this.Qa=0,s},n.prototype.next=function(){if(this.eb===null)return{done:!0};if(this.Za!==null&&(this.Za.free(),this.Za=null),!this.db.db)throw this.mb(),Error("Database closed");var s=we(),u=Bt(4);G(a),G(u);try{this.db.handleError(Rr(this.db.db,this.kb,-1,a,u)),this.kb=C(u,"i32");var y=C(a,"i32");return y===0?(this.mb(),{done:!0}):(this.Za=new r(y,this.db),this.db.fb[y]=this.Za,{value:this.Za,done:!1})}catch(E){throw this.pb=K(this.kb),this.mb(),E}finally{be(s)}},n.prototype.mb=function(){De(this.eb),this.eb=null},n.prototype.getRemainingSQL=function(){return this.pb!==null?this.pb:K(this.kb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(n.prototype[Symbol.iterator]=function(){return this}),o.prototype.run=function(s,u){if(!this.db)throw"Database closed";if(u){s=this.prepare(s,u);try{s.step()}finally{s.free()}}else this.handleError(k(this.db,s,0,0,a));return this},o.prototype.exec=function(s,u,y){if(!this.db)throw"Database closed";var E=we(),L=null;try{var W=Ze(s),gt=Bt(4);for(s=[];C(W,"i8")!==0;){G(a),G(gt),this.handleError(Rr(this.db,W,-1,a,gt));var _t=C(a,"i32");if(W=C(gt,"i32"),_t!==0){var bt=null;for(L=new r(_t,this),u!=null&&L.bind(u);L.step();)bt===null&&(bt={columns:L.getColumnNames(),values:[]},s.push(bt)),bt.values.push(L.get(null,y));L.free()}}return s}catch(vt){throw L&&L.free(),vt}finally{be(E)}},o.prototype.each=function(s,u,y,E,L){typeof u=="function"&&(E=y,y=u,u=void 0),s=this.prepare(s,u);try{for(;s.step();)y(s.getAsObject(null,L))}finally{s.free()}if(typeof E=="function")return E()},o.prototype.prepare=function(s,u){if(G(a),this.handleError(dt(this.db,s,-1,a,0)),s=C(a,"i32"),s===0)throw"Nothing to prepare";var y=new r(s,this);return u!=null&&y.bind(u),this.fb[s]=y},o.prototype.iterateStatements=function(s){return new n(s,this)},o.prototype.export=function(){Object.values(this.fb).forEach(function(u){u.free()}),Object.values(this.Sa).forEach(Ft),this.Sa={},this.handleError(O(this.db));var s=Hr(this.filename);return this.handleError(v(this.filename,a)),this.db=C(a,"i32"),Or(this.db),s},o.prototype.close=function(){this.db!==null&&(Object.values(this.fb).forEach(function(s){s.free()}),Object.values(this.Sa).forEach(Ft),this.Sa={},this.Ya&&(Ft(this.Ya),this.Ya=void 0),this.handleError(O(this.db)),br("/"+this.filename),this.db=null)},o.prototype.handleError=function(s){if(s===0)return null;throw s=an(this.db),Error(s)},o.prototype.getRowsModified=function(){return Z(this.db)},o.prototype.create_function=function(s,u){Object.prototype.hasOwnProperty.call(this.Sa,s)&&(Ft(this.Sa[s]),delete this.Sa[s]);var y=pe(function(E,L,W){L=e(L,W);try{var gt=u.apply(null,L)}catch(_t){Ne(E,_t,-1);return}t(E,gt)},"viii");return this.Sa[s]=y,this.handleError(kr(this.db,s,u.length,1,0,y,0,0,0)),this},o.prototype.create_aggregate=function(s,u){var y=u.init||function(){return null},E=u.finalize||function(bt){return bt},L=u.step;if(!L)throw"An aggregate function must have a step function in "+s;var W={};Object.hasOwnProperty.call(this.Sa,s)&&(Ft(this.Sa[s]),delete this.Sa[s]),u=s+"__finalize",Object.hasOwnProperty.call(this.Sa,u)&&(Ft(this.Sa[u]),delete this.Sa[u]);var gt=pe(function(bt,vt,er){var Vt=Tr(bt,1);Object.hasOwnProperty.call(W,Vt)||(W[Vt]=y()),vt=e(vt,er),vt=[W[Vt]].concat(vt);try{W[Vt]=L.apply(null,vt)}catch(Rn){delete W[Vt],Ne(bt,Rn,-1)}},"viii"),_t=pe(function(bt){var vt=Tr(bt,1);try{var er=E(W[vt])}catch(Vt){delete W[vt],Ne(bt,Vt,-1);return}t(bt,er),delete W[vt]},"vi");return this.Sa[s]=gt,this.Sa[u]=_t,this.handleError(kr(this.db,s,L.length-1,1,0,0,gt,_t,0)),this},o.prototype.updateHook=function(s){this.Ya&&(zr(this.db,0,0),Ft(this.Ya),this.Ya=void 0),s&&(this.Ya=pe(function(u,y,E,L,W){switch(y){case 18:u="insert";break;case 23:u="update";break;case 9:u="delete";break;default:throw"unknown operationCode in updateHook callback: "+y}if(E=E?T(D,E):"",L=L?T(D,L):"",W>Number.MAX_SAFE_INTEGER)throw"rowId too big to fit inside a Number";s(u,E,L,Number(W))},"viiiij"),zr(this.db,this.Ya,0))},i.Database=o};var xt={...i},st="./this.program",mt=(t,e)=>{throw e},Y="",wt,kt;if(et){var Ut=Pr;Y=__dirname+"/",kt=t=>(t=rt(t)?new URL(t):t,Ut.readFileSync(t)),wt=async t=>(t=rt(t)?new URL(t):t,Ut.readFileSync(t,void 0)),!i.thisProgram&&1<process.argv.length&&(st=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),c.exports=i,mt=(t,e)=>{throw process.exitCode=t,e}}else(X||U)&&(U?Y=self.location.href:typeof document<"u"&&document.currentScript&&(Y=document.currentScript.src),Y=Y.startsWith("blob:")?"":Y.slice(0,Y.replace(/[?#].*/,"").lastIndexOf("/")+1),U&&(kt=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),wt=async t=>{if(rt(t))return new Promise((r,n)=>{var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer",o.onload=()=>{o.status==200||o.status==0&&o.response?r(o.response):n(o.status)},o.onerror=n,o.send(null)});var e=await fetch(t,{credentials:"same-origin"});if(e.ok)return e.arrayBuffer();throw Error(e.status+" : "+e.url)});var _e=i.print||console.log.bind(console),yt=i.printErr||console.error.bind(console);Object.assign(i,xt),xt=null,i.thisProgram&&(st=i.thisProgram);var jt=i.wasmBinary,Mt,St=!1,Zt,J,D,pt,I,V,se,ut,ae,rt=t=>t.startsWith("file://");function ge(){var t=Mt.buffer;i.HEAP8=J=new Int8Array(t),i.HEAP16=pt=new Int16Array(t),i.HEAPU8=D=new Uint8Array(t),i.HEAPU16=new Uint16Array(t),i.HEAP32=I=new Int32Array(t),i.HEAPU32=V=new Uint32Array(t),i.HEAPF32=se=new Float32Array(t),i.HEAPF64=ae=new Float64Array(t),i.HEAP64=ut=new BigInt64Array(t),i.HEAPU64=new BigUint64Array(t)}var Rt=0,Wt=null;function at(t){throw i.onAbort?.(t),t="Aborted("+t+")",yt(t),St=!0,new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info.")}var le;async function $t(t){if(!jt)try{var e=await wt(t);return new Uint8Array(e)}catch{}if(t==le&&jt)t=new Uint8Array(jt);else if(kt)t=kt(t);else throw"both async and sync fetching of the wasm failed";return t}async function ve(t,e){try{var r=await $t(t);return await WebAssembly.instantiate(r,e)}catch(n){yt(`failed to asynchronously prepare wasm: ${n}`),at(n)}}async function Tt(t){var e=le;if(!jt&&typeof WebAssembly.instantiateStreaming=="function"&&!rt(e)&&!et)try{var r=fetch(e,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(r,t)}catch(n){yt(`wasm streaming compile failed: ${n}`),yt("falling back to ArrayBuffer instantiation")}return ve(e,t)}class Yt{name="ExitStatus";constructor(e){this.message=`Program terminated with exit(${e})`,this.status=e}}var xe=t=>{for(;0<t.length;)t.shift()(i)},f=[],_=[],q=()=>{var t=i.preRun.shift();_.unshift(t)};function C(t,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":return J[t];case"i8":return J[t];case"i16":return pt[t>>1];case"i32":return I[t>>2];case"i64":return ut[t>>3];case"float":return se[t>>2];case"double":return ae[t>>3];case"*":return V[t>>2];default:at(`invalid type for getValue: ${e}`)}}var p=i.noExitRuntime||!0;function G(t){var e="i32";switch(e.endsWith("*")&&(e="*"),e){case"i1":J[t]=0;break;case"i8":J[t]=0;break;case"i16":pt[t>>1]=0;break;case"i32":I[t>>2]=0;break;case"i64":ut[t>>3]=BigInt(0);break;case"float":se[t>>2]=0;break;case"double":ae[t>>3]=0;break;case"*":V[t>>2]=0;break;default:at(`invalid type for setValue: ${e}`)}}var x=typeof TextDecoder<"u"?new TextDecoder:void 0,T=(t,e=0,r=NaN)=>{var n=e+r;for(r=e;t[r]&&!(r>=n);)++r;if(16<r-e&&t.buffer&&x)return x.decode(t.subarray(e,r));for(n="";e<r;){var o=t[e++];if(o&128){var a=t[e++]&63;if((o&224)==192)n+=String.fromCharCode((o&31)<<6|a);else{var l=t[e++]&63;o=(o&240)==224?(o&15)<<12|a<<6|l:(o&7)<<18|a<<12|l<<6|t[e++]&63,65536>o?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296|o>>10,56320|o&1023))}}else n+=String.fromCharCode(o)}return n},K=(t,e)=>t?T(D,t,e):"",ue=(t,e)=>{for(var r=0,n=t.length-1;0<=n;n--){var o=t[n];o==="."?t.splice(n,1):o===".."?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r;r--)t.unshift("..");return t},Kt=t=>{var e=t.charAt(0)==="/",r=t.slice(-1)==="/";return(t=ue(t.split("/").filter(n=>!!n),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t},Jt=t=>{var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);return t=e[0],e=e[1],!t&&!e?".":(e&&=e.slice(0,-1),t+e)},Ot=t=>t&&t.match(/([^\/]+|\/)\/*$/)[1],ce=()=>{if(et){var t=Pr;return e=>t.randomFillSync(e)}return e=>crypto.getRandomValues(e)},te=t=>{(te=ce())(t)},Me=(...t)=>{for(var e="",r=!1,n=t.length-1;-1<=n&&!r;n--){if(r=0<=n?t[n]:"/",typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)return"";e=r+"/"+e,r=r.charAt(0)==="/"}return e=ue(e.split("/").filter(o=>!!o),!r).join("/"),(r?"/":"")+e||"."},zt=[],Ct=t=>{for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);127>=n?e++:2047>=n?e+=2:55296<=n&&57343>=n?(e+=4,++r):e+=3}return e},tt=(t,e,r,n)=>{if(!(0<n))return 0;var o=r;n=r+n-1;for(var a=0;a<t.length;++a){var l=t.charCodeAt(a);if(55296<=l&&57343>=l){var v=t.charCodeAt(++a);l=65536+((l&1023)<<10)|v&1023}if(127>=l){if(r>=n)break;e[r++]=l}else{if(2047>=l){if(r+1>=n)break;e[r++]=192|l>>6}else{if(65535>=l){if(r+2>=n)break;e[r++]=224|l>>12}else{if(r+3>=n)break;e[r++]=240|l>>18,e[r++]=128|l>>12&63}e[r++]=128|l>>6&63}e[r++]=128|l&63}}return e[r]=0,r-o},fe=(t,e)=>{var r=Array(Ct(t)+1);return t=tt(t,r,0,r.length),e&&(r.length=t),r},Ee=[];function qe(t,e){Ee[t]={input:[],output:[],cb:e},Ye(t,Se)}var Se={open(t){var e=Ee[t.node.rdev];if(!e)throw new m(43);t.tty=e,t.seekable=!1},close(t){t.tty.cb.fsync(t.tty)},fsync(t){t.tty.cb.fsync(t.tty)},read(t,e,r,n){if(!t.tty||!t.tty.cb.xb)throw new m(60);for(var o=0,a=0;a<n;a++){try{var l=t.tty.cb.xb(t.tty)}catch{throw new m(29)}if(l===void 0&&o===0)throw new m(6);if(l==null)break;o++,e[r+a]=l}return o&&(t.node.atime=Date.now()),o},write(t,e,r,n){if(!t.tty||!t.tty.cb.qb)throw new m(60);try{for(var o=0;o<n;o++)t.tty.cb.qb(t.tty,e[r+o])}catch{throw new m(29)}return n&&(t.node.mtime=t.node.ctime=Date.now()),o}},Ue={xb(){t:{if(!zt.length){var t=null;if(et){var e=Buffer.alloc(256),r=0,n=process.stdin.fd;try{r=Ut.readSync(n,e,0,256)}catch(o){if(o.toString().includes("EOF"))r=0;else throw o}0<r&&(t=e.slice(0,r).toString("utf-8"))}else typeof window<"u"&&typeof window.prompt=="function"&&(t=window.prompt("Input: "),t!==null&&(t+=`
`));if(!t){t=null;break t}zt=fe(t,!0)}t=zt.shift()}return t},qb(t,e){e===null||e===10?(_e(T(t.output)),t.output=[]):e!=0&&t.output.push(e)},fsync(t){0<t.output?.length&&(_e(T(t.output)),t.output=[])},Tb(){return{Ob:25856,Qb:5,Nb:191,Pb:35387,Mb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Ub(){return 0},Vb(){return[24,80]}},Re={qb(t,e){e===null||e===10?(yt(T(t.output)),t.output=[]):e!=0&&t.output.push(e)},fsync(t){0<t.output?.length&&(yt(T(t.output)),t.output=[])}},R={Wa:null,Xa(){return R.createNode(null,"/",16895,0)},createNode(t,e,r,n){if((r&61440)===24576||(r&61440)===4096)throw new m(63);return R.Wa||(R.Wa={dir:{node:{Ta:R.La.Ta,Ua:R.La.Ua,lookup:R.La.lookup,hb:R.La.hb,rename:R.La.rename,unlink:R.La.unlink,rmdir:R.La.rmdir,readdir:R.La.readdir,symlink:R.La.symlink},stream:{Va:R.Ma.Va}},file:{node:{Ta:R.La.Ta,Ua:R.La.Ua},stream:{Va:R.Ma.Va,read:R.Ma.read,write:R.Ma.write,ib:R.Ma.ib,jb:R.Ma.jb}},link:{node:{Ta:R.La.Ta,Ua:R.La.Ua,readlink:R.La.readlink},stream:{}},ub:{node:{Ta:R.La.Ta,Ua:R.La.Ua},stream:Xr}}),r=ur(t,e,r,n),ht(r.mode)?(r.La=R.Wa.dir.node,r.Ma=R.Wa.dir.stream,r.Na={}):(r.mode&61440)===32768?(r.La=R.Wa.file.node,r.Ma=R.Wa.file.stream,r.Ra=0,r.Na=null):(r.mode&61440)===40960?(r.La=R.Wa.link.node,r.Ma=R.Wa.link.stream):(r.mode&61440)===8192&&(r.La=R.Wa.ub.node,r.Ma=R.Wa.ub.stream),r.atime=r.mtime=r.ctime=Date.now(),t&&(t.Na[e]=r,t.atime=t.mtime=t.ctime=r.atime),r},Sb(t){return t.Na?t.Na.subarray?t.Na.subarray(0,t.Ra):new Uint8Array(t.Na):new Uint8Array(0)},La:{Ta(t){var e={};return e.dev=(t.mode&61440)===8192?t.id:1,e.ino=t.id,e.mode=t.mode,e.nlink=1,e.uid=0,e.gid=0,e.rdev=t.rdev,ht(t.mode)?e.size=4096:(t.mode&61440)===32768?e.size=t.Ra:(t.mode&61440)===40960?e.size=t.link.length:e.size=0,e.atime=new Date(t.atime),e.mtime=new Date(t.mtime),e.ctime=new Date(t.ctime),e.blksize=4096,e.blocks=Math.ceil(e.size/e.blksize),e},Ua(t,e){for(var r of["mode","atime","mtime","ctime"])e[r]!=null&&(t[r]=e[r]);e.size!==void 0&&(e=e.size,t.Ra!=e&&(e==0?(t.Na=null,t.Ra=0):(r=t.Na,t.Na=new Uint8Array(e),r&&t.Na.set(r.subarray(0,Math.min(e,t.Ra))),t.Ra=e)))},lookup(){throw R.vb},hb(t,e,r,n){return R.createNode(t,e,r,n)},rename(t,e,r){try{var n=it(e,r)}catch{}if(n){if(ht(t.mode))for(var o in n.Na)throw new m(55);Nt(n)}delete t.parent.Na[t.name],e.Na[r]=t,t.name=r,e.ctime=e.mtime=t.parent.ctime=t.parent.mtime=Date.now()},unlink(t,e){delete t.Na[e],t.ctime=t.mtime=Date.now()},rmdir(t,e){var r=it(t,e),n;for(n in r.Na)throw new m(55);delete t.Na[e],t.ctime=t.mtime=Date.now()},readdir(t){return[".","..",...Object.keys(t.Na)]},symlink(t,e,r){return t=R.createNode(t,e,41471,0),t.link=r,t},readlink(t){if((t.mode&61440)!==40960)throw new m(28);return t.link}},Ma:{read(t,e,r,n,o){var a=t.node.Na;if(o>=t.node.Ra)return 0;if(t=Math.min(t.node.Ra-o,n),8<t&&a.subarray)e.set(a.subarray(o,o+t),r);else for(n=0;n<t;n++)e[r+n]=a[o+n];return t},write(t,e,r,n,o,a){if(e.buffer===J.buffer&&(a=!1),!n)return 0;if(t=t.node,t.mtime=t.ctime=Date.now(),e.subarray&&(!t.Na||t.Na.subarray)){if(a)return t.Na=e.subarray(r,r+n),t.Ra=n;if(t.Ra===0&&o===0)return t.Na=e.slice(r,r+n),t.Ra=n;if(o+n<=t.Ra)return t.Na.set(e.subarray(r,r+n),o),n}a=o+n;var l=t.Na?t.Na.length:0;if(l>=a||(a=Math.max(a,l*(1048576>l?2:1.125)>>>0),l!=0&&(a=Math.max(a,256)),l=t.Na,t.Na=new Uint8Array(a),0<t.Ra&&t.Na.set(l.subarray(0,t.Ra),0)),t.Na.subarray&&e.subarray)t.Na.set(e.subarray(r,r+n),o);else for(a=0;a<n;a++)t.Na[o+a]=e[r+a];return t.Ra=Math.max(t.Ra,o+n),n},Va(t,e,r){if(r===1?e+=t.position:r===2&&(t.node.mode&61440)===32768&&(e+=t.node.Ra),0>e)throw new m(28);return e},ib(t,e,r,n,o){if((t.node.mode&61440)!==32768)throw new m(43);if(t=t.node.Na,o&2||!t||t.buffer!==J.buffer){o=!0,n=65536*Math.ceil(e/65536);var a=Er(65536,n);if(a&&D.fill(0,a,a+n),n=a,!n)throw new m(48);t&&((0<r||r+e<t.length)&&(t.subarray?t=t.subarray(r,r+e):t=Array.prototype.slice.call(t,r,r+e)),J.set(t,n))}else o=!1,n=t.byteOffset;return{Kb:n,Ab:o}},jb(t,e,r,n){return R.Ma.write(t,e,0,n,r,!1),0}}},Xt=(t,e)=>{var r=0;return t&&(r|=365),e&&(r|=146),r},he=null,S={},A=[],F=1,$=null,nt=!1,ct=!0,ot={},m=class{name="ErrnoError";constructor(t){this.Pa=t}},At=class{gb={};node=null;get flags(){return this.gb.flags}set flags(t){this.gb.flags=t}get position(){return this.gb.position}set position(t){this.gb.position=t}},We=class{La={};Ma={};ab=null;constructor(t,e,r,n){t||=this,this.parent=t,this.Xa=t.Xa,this.id=F++,this.name=e,this.mode=r,this.rdev=n,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&365)===365}set read(t){t?this.mode|=365:this.mode&=-366}get write(){return(this.mode&146)===146}set write(t){t?this.mode|=146:this.mode&=-147}};function ft(t,e={}){if(!t)throw new m(44);e.nb??(e.nb=!0),t.charAt(0)==="/"||(t="//"+t);var r=0;t:for(;40>r;r++){t=t.split("/").filter(v=>!!v);for(var n=he,o="/",a=0;a<t.length;a++){var l=a===t.length-1;if(l&&e.parent)break;if(t[a]!==".")if(t[a]==="..")o=Jt(o),n=n.parent;else{o=Kt(o+"/"+t[a]);try{n=it(n,t[a])}catch(v){if(v?.Pa===44&&l&&e.Jb)return{path:o};throw v}if(!n.ab||l&&!e.nb||(n=n.ab.root),(n.mode&61440)===40960&&(!l||e.$a)){if(!n.La.readlink)throw new m(52);n=n.La.readlink(n),n.charAt(0)==="/"||(n=Jt(o)+"/"+n),t=n+"/"+t.slice(a+1).join("/");continue t}}}return{path:o,node:n}}throw new m(32)}function Pt(t){for(var e;;){if(t===t.parent)return t=t.Xa.zb,e?t[t.length-1]!=="/"?`${t}/${e}`:t+e:t;e=e?`${t.name}/${e}`:t.name,t=t.parent}}function Dt(t,e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n)|0;return(t+r>>>0)%$.length}function Nt(t){var e=Dt(t.parent.id,t.name);if($[e]===t)$[e]=t.bb;else for(e=$[e];e;){if(e.bb===t){e.bb=t.bb;break}e=e.bb}}function it(t,e){var r=ht(t.mode)?(r=ee(t,"x"))?r:t.La.lookup?0:2:54;if(r)throw new m(r);for(r=$[Dt(t.id,e)];r;r=r.bb){var n=r.name;if(r.parent.id===t.id&&n===e)return r}return t.La.lookup(t,e)}function ur(t,e,r,n){return t=new We(t,e,r,n),e=Dt(t.parent.id,t.name),t.bb=$[e],$[e]=t}function ht(t){return(t&61440)===16384}function cr(t){var e=["r","w","rw"][t&3];return t&512&&(e+="w"),e}function ee(t,e){if(ct)return 0;if(!e.includes("r")||t.mode&292){if(e.includes("w")&&!(t.mode&146)||e.includes("x")&&!(t.mode&73))return 2}else return 2;return 0}function fr(t,e){if(!ht(t.mode))return 54;try{return it(t,e),20}catch{}return ee(t,"wx")}function hr(t,e,r){try{var n=it(t,e)}catch(o){return o.Pa}if(t=ee(t,"wx"))return t;if(r){if(!ht(n.mode))return 54;if(n===n.parent||Pt(n)==="/")return 10}else if(ht(n.mode))return 31;return 0}function Ae(t){if(!t)throw new m(63);return t}function lt(t){if(t=A[t],!t)throw new m(8);return t}function dr(t,e=-1){if(t=Object.assign(new At,t),e==-1)t:{for(e=0;4096>=e;e++)if(!A[e])break t;throw new m(33)}return t.fd=e,A[e]=t}function Yr(t,e=-1){return t=dr(t,e),t.Ma?.Rb?.(t),t}function $e(t,e,r){var n=t?.Ma.Ua;t=n?t:e,n??=e.La.Ua,Ae(n),n(t,r)}var Xr={open(t){t.Ma=S[t.node.rdev].Ma,t.Ma.open?.(t)},Va(){throw new m(70)}};function Ye(t,e){S[t]={Ma:e}}function mr(t,e){var r=e==="/";if(r&&he)throw new m(10);if(!r&&e){var n=ft(e,{nb:!1});if(e=n.path,n=n.node,n.ab)throw new m(10);if(!ht(n.mode))throw new m(54)}e={type:t,Wb:{},zb:e,Ib:[]},t=t.Xa(e),t.Xa=e,e.root=t,r?he=t:n&&(n.ab=e,n.Xa&&n.Xa.Ib.push(e))}function Le(t,e,r){var n=ft(t,{parent:!0}).node;if(t=Ot(t),!t)throw new m(28);if(t==="."||t==="..")throw new m(20);var o=fr(n,t);if(o)throw new m(o);if(!n.La.hb)throw new m(63);return n.La.hb(n,t,e,r)}function Qr(t,e=438){return Le(t,e&4095|32768,0)}function Et(t,e=511){return Le(t,e&1023|16384,0)}function ke(t,e,r){typeof r>"u"&&(r=e,e=438),Le(t,e|8192,r)}function Xe(t,e){if(!Me(t))throw new m(44);var r=ft(e,{parent:!0}).node;if(!r)throw new m(44);e=Ot(e);var n=fr(r,e);if(n)throw new m(n);if(!r.La.symlink)throw new m(63);r.La.symlink(r,e,t)}function pr(t){var e=ft(t,{parent:!0}).node;t=Ot(t);var r=it(e,t),n=hr(e,t,!0);if(n)throw new m(n);if(!e.La.rmdir)throw new m(63);if(r.ab)throw new m(10);e.La.rmdir(e,t),Nt(r)}function br(t){var e=ft(t,{parent:!0}).node;if(!e)throw new m(44);t=Ot(t);var r=it(e,t),n=hr(e,t,!1);if(n)throw new m(n);if(!e.La.unlink)throw new m(63);if(r.ab)throw new m(10);e.La.unlink(e,t),Nt(r)}function de(t,e){return t=ft(t,{$a:!e}).node,Ae(t.La.Ta)(t)}function wr(t,e,r,n){$e(t,e,{mode:r&4095|e.mode&-4096,ctime:Date.now(),Fb:n})}function je(t,e){t=typeof t=="string"?ft(t,{$a:!0}).node:t,wr(null,t,e)}function yr(t,e,r){if(ht(e.mode))throw new m(31);if((e.mode&61440)!==32768)throw new m(28);var n=ee(e,"w");if(n)throw new m(n);$e(t,e,{size:r,timestamp:Date.now()})}function re(t,e,r=438){if(t==="")throw new m(44);if(typeof e=="string"){var n={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(typeof n>"u")throw Error(`Unknown file open mode: ${e}`);e=n}if(r=e&64?r&4095|32768:0,typeof t=="object")n=t;else{var o=t.endsWith("/");t=ft(t,{$a:!(e&131072),Jb:!0}),n=t.node,t=t.path}var a=!1;if(e&64)if(n){if(e&128)throw new m(20)}else{if(o)throw new m(31);n=Le(t,r|511,0),a=!0}if(!n)throw new m(44);if((n.mode&61440)===8192&&(e&=-513),e&65536&&!ht(n.mode))throw new m(54);if(!a&&(o=n?(n.mode&61440)===40960?32:ht(n.mode)&&(cr(e)!=="r"||e&576)?31:ee(n,cr(e)):44))throw new m(o);return e&512&&!a&&(o=n,o=typeof o=="string"?ft(o,{$a:!0}).node:o,yr(null,o,0)),e&=-131713,o=dr({node:n,path:Pt(n),flags:e,seekable:!0,position:0,Ma:n.Ma,Lb:[],error:!1}),o.Ma.open&&o.Ma.open(o),a&&je(n,r&511),!i.logReadFiles||e&1||t in ot||(ot[t]=1),o}function Qe(t){if(t.fd===null)throw new m(8);t.ob&&(t.ob=null);try{t.Ma.close&&t.Ma.close(t)}catch(e){throw e}finally{A[t.fd]=null}t.fd=null}function _r(t,e,r){if(t.fd===null)throw new m(8);if(!t.seekable||!t.Ma.Va)throw new m(70);if(r!=0&&r!=1&&r!=2)throw new m(28);t.position=t.Ma.Va(t,e,r),t.Lb=[]}function gr(t,e,r,n,o){if(0>n||0>o)throw new m(28);if(t.fd===null)throw new m(8);if((t.flags&2097155)===1)throw new m(8);if(ht(t.node.mode))throw new m(31);if(!t.Ma.read)throw new m(28);var a=typeof o<"u";if(!a)o=t.position;else if(!t.seekable)throw new m(70);return e=t.Ma.read(t,e,r,n,o),a||(t.position+=e),e}function vr(t,e,r,n,o){if(0>n||0>o)throw new m(28);if(t.fd===null)throw new m(8);if((t.flags&2097155)===0)throw new m(8);if(ht(t.node.mode))throw new m(31);if(!t.Ma.write)throw new m(28);t.seekable&&t.flags&1024&&_r(t,0,2);var a=typeof o<"u";if(!a)o=t.position;else if(!t.seekable)throw new m(70);return e=t.Ma.write(t,e,r,n,o,void 0),a||(t.position+=e),e}function Hr(t){var e,r=re(t,r||0);t=de(t).size;var n=new Uint8Array(t);return gr(r,n,0,t,0),e=n,Qe(r),e}function It(t,e,r){t=Kt("/dev/"+t);var n=Xt(!!e,!!r);It.yb??(It.yb=64);var o=It.yb++<<8|0;Ye(o,{open(a){a.seekable=!1},close(){r?.buffer?.length&&r(10)},read(a,l,v,O){for(var k=0,Z=0;Z<O;Z++){try{var dt=e()}catch{throw new m(29)}if(dt===void 0&&k===0)throw new m(6);if(dt==null)break;k++,l[v+Z]=dt}return k&&(a.node.atime=Date.now()),k},write(a,l,v,O){for(var k=0;k<O;k++)try{r(l[v+k])}catch{throw new m(29)}return O&&(a.node.mtime=a.node.ctime=Date.now()),k}}),ke(t,n,o)}var Q={};function Qt(t,e,r){if(e.charAt(0)==="/")return e;if(t=t===-100?"/":lt(t).path,e.length==0){if(!r)throw new m(44);return t}return t+"/"+e}function Te(t,e){I[t>>2]=e.dev,I[t+4>>2]=e.mode,V[t+8>>2]=e.nlink,I[t+12>>2]=e.uid,I[t+16>>2]=e.gid,I[t+20>>2]=e.rdev,ut[t+24>>3]=BigInt(e.size),I[t+32>>2]=4096,I[t+36>>2]=e.blocks;var r=e.atime.getTime(),n=e.mtime.getTime(),o=e.ctime.getTime();return ut[t+40>>3]=BigInt(Math.floor(r/1e3)),V[t+48>>2]=r%1e3*1e6,ut[t+56>>3]=BigInt(Math.floor(n/1e3)),V[t+64>>2]=n%1e3*1e6,ut[t+72>>3]=BigInt(Math.floor(o/1e3)),V[t+80>>2]=o%1e3*1e6,ut[t+88>>3]=BigInt(e.ino),0}var Oe=void 0,ze=()=>{var t=I[+Oe>>2];return Oe+=4,t},He=0,Vr=[0,31,60,91,121,152,182,213,244,274,305,335],Gr=[0,31,59,90,120,151,181,212,243,273,304,334],me={},xr=t=>{Zt=t,p||0<He||(i.onExit?.(t),St=!0),mt(t,new Yt(t))},Zr=t=>{if(!St)try{if(t(),!(p||0<He))try{Zt=t=Zt,xr(t)}catch(e){e instanceof Yt||e=="unwind"||mt(1,e)}}catch(e){e instanceof Yt||e=="unwind"||mt(1,e)}},Ve={},Mr=()=>{if(!Ge){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:st||"./this.program"},e;for(e in Ve)Ve[e]===void 0?delete t[e]:t[e]=Ve[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);Ge=r}return Ge},Ge,Ze=t=>{var e=Ct(t)+1,r=Bt(e);return tt(t,D,r,e),r},Kr=(t,e,r,n)=>{var o={string:k=>{var Z=0;return k!=null&&k!==0&&(Z=Ze(k)),Z},array:k=>{var Z=Bt(k.length);return J.set(k,Z),Z}};t=i["_"+t];var a=[],l=0;if(n)for(var v=0;v<n.length;v++){var O=o[r[v]];O?(l===0&&(l=we()),a[v]=O(n[v])):a[v]=n[v]}return r=t(...a),r=(function(k){return l!==0&&be(l),e==="string"?k?T(D,k):"":e==="boolean"?!!k:k})(r)},Ce=0,Pe=(t,e)=>(e=e==1?Bt(t.length):Je(t.length),t.subarray||t.slice||(t=new Uint8Array(t)),D.set(t,e),e),Ht,Ke=[],Lt,Ft=t=>{Ht.delete(Lt.get(t)),Lt.set(t,null),Ke.push(t)},pe=(t,e)=>{if(!Ht){Ht=new WeakMap;var r=Lt.length;if(Ht)for(var n=0;n<0+r;n++){var o=Lt.get(n);o&&Ht.set(o,n)}}if(r=Ht.get(t)||0)return r;if(Ke.length)r=Ke.pop();else{try{Lt.grow(1)}catch(O){throw O instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":O}r=Lt.length-1}try{Lt.set(r,t)}catch(O){if(!(O instanceof TypeError))throw O;if(typeof WebAssembly.Function=="function"){var a=WebAssembly.Function;n={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:e[0]=="v"?[]:[n[e[0]]]};for(var l=1;l<e.length;++l)o.parameters.push(n[e[l]]);e=new a(o,t)}else{n=[1],o=e.slice(0,1),e=e.slice(1),l={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96);var v=e.length;128>v?n.push(v):n.push(v%128|128,v>>7);for(a of e)n.push(l[a]);o=="v"?n.push(0):n.push(1,l[o]),e=[0,97,115,109,1,0,0,0,1],a=n.length,128>a?e.push(a):e.push(a%128|128,a>>7),e.push(...n),e.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),e=new WebAssembly.Module(new Uint8Array(e)),e=new WebAssembly.Instance(e,{e:{f:t}}).exports.f}Lt.set(r,e)}return Ht.set(t,r),r};$=Array(4096),mr(R,"/"),Et("/tmp"),Et("/home"),Et("/home/web_user"),(function(){Et("/dev"),Ye(259,{read:()=>0,write:(n,o,a,l)=>l,Va:()=>0}),ke("/dev/null",259),qe(1280,Ue),qe(1536,Re),ke("/dev/tty",1280),ke("/dev/tty1",1536);var t=new Uint8Array(1024),e=0,r=()=>(e===0&&(te(t),e=t.byteLength),t[--e]);It("random",r),It("urandom",r),Et("/dev/shm"),Et("/dev/shm/tmp")})(),(function(){Et("/proc");var t=Et("/proc/self");Et("/proc/self/fd"),mr({Xa(){var e=ur(t,"fd",16895,73);return e.Ma={Va:R.Ma.Va},e.La={lookup(r,n){r=+n;var o=lt(r);return r={parent:null,Xa:{zb:"fake"},La:{readlink:()=>o.path},id:r+1},r.parent=r},readdir(){return Array.from(A.entries()).filter(([,r])=>r).map(([r])=>r.toString())}},e}},"/proc/self/fd")})(),R.vb=new m(44),R.vb.stack="<generic error, no stack>";var Jr={a:(t,e,r,n)=>at(`Assertion failed: ${t?T(D,t):""}, at: `+[e?e?T(D,e):"":"unknown filename",r,n?n?T(D,n):"":"unknown function"]),i:function(t,e){try{return t=t?T(D,t):"",je(t,e),0}catch(r){if(typeof Q>"u"||r.name!=="ErrnoError")throw r;return-r.Pa}},L:function(t,e,r){try{if(e=e?T(D,e):"",e=Qt(t,e),r&-8)return-28;var n=ft(e,{$a:!0}).node;return n?(t="",r&4&&(t+="r"),r&2&&(t+="w"),r&1&&(t+="x"),t&&ee(n,t)?-2:0):-44}catch(o){if(typeof Q>"u"||o.name!=="ErrnoError")throw o;return-o.Pa}},j:function(t,e){try{var r=lt(t);return wr(r,r.node,e,!1),0}catch(n){if(typeof Q>"u"||n.name!=="ErrnoError")throw n;return-n.Pa}},h:function(t){try{var e=lt(t);return $e(e,e.node,{timestamp:Date.now(),Fb:!1}),0}catch(r){if(typeof Q>"u"||r.name!=="ErrnoError")throw r;return-r.Pa}},b:function(t,e,r){Oe=r;try{var n=lt(t);switch(e){case 0:var o=ze();if(0>o)break;for(;A[o];)o++;return Yr(n,o).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:return o=ze(),n.flags|=o,0;case 12:return o=ze(),pt[o+0>>1]=2,0;case 13:case 14:return 0}return-28}catch(a){if(typeof Q>"u"||a.name!=="ErrnoError")throw a;return-a.Pa}},g:function(t,e){try{var r=lt(t),n=r.node,o=r.Ma.Ta;t=o?r:n,o??=n.La.Ta,Ae(o);var a=o(t);return Te(e,a)}catch(l){if(typeof Q>"u"||l.name!=="ErrnoError")throw l;return-l.Pa}},H:function(t,e){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e);try{if(isNaN(e))return 61;var r=lt(t);if(0>e||(r.flags&2097155)===0)throw new m(28);return yr(r,r.node,e),0}catch(n){if(typeof Q>"u"||n.name!=="ErrnoError")throw n;return-n.Pa}},G:function(t,e){try{if(e===0)return-28;var r=Ct("/")+1;return e<r?-68:(tt("/",D,t,e),r)}catch(n){if(typeof Q>"u"||n.name!=="ErrnoError")throw n;return-n.Pa}},K:function(t,e){try{return t=t?T(D,t):"",Te(e,de(t,!0))}catch(r){if(typeof Q>"u"||r.name!=="ErrnoError")throw r;return-r.Pa}},C:function(t,e,r){try{return e=e?T(D,e):"",e=Qt(t,e),Et(e,r),0}catch(n){if(typeof Q>"u"||n.name!=="ErrnoError")throw n;return-n.Pa}},J:function(t,e,r,n){try{e=e?T(D,e):"";var o=n&256;return e=Qt(t,e,n&4096),Te(r,o?de(e,!0):de(e))}catch(a){if(typeof Q>"u"||a.name!=="ErrnoError")throw a;return-a.Pa}},x:function(t,e,r,n){Oe=n;try{e=e?T(D,e):"",e=Qt(t,e);var o=n?ze():0;return re(e,r,o).fd}catch(a){if(typeof Q>"u"||a.name!=="ErrnoError")throw a;return-a.Pa}},v:function(t,e,r,n){try{if(e=e?T(D,e):"",e=Qt(t,e),0>=n)return-28;var o=ft(e).node;if(!o)throw new m(44);if(!o.La.readlink)throw new m(28);var a=o.La.readlink(o),l=Math.min(n,Ct(a)),v=J[r+l];return tt(a,D,r,n+1),J[r+l]=v,l}catch(O){if(typeof Q>"u"||O.name!=="ErrnoError")throw O;return-O.Pa}},u:function(t){try{return t=t?T(D,t):"",pr(t),0}catch(e){if(typeof Q>"u"||e.name!=="ErrnoError")throw e;return-e.Pa}},f:function(t,e){try{return t=t?T(D,t):"",Te(e,de(t))}catch(r){if(typeof Q>"u"||r.name!=="ErrnoError")throw r;return-r.Pa}},r:function(t,e,r){try{return e=e?T(D,e):"",e=Qt(t,e),r===0?br(e):r===512?pr(e):at("Invalid flags passed to unlinkat"),0}catch(n){if(typeof Q>"u"||n.name!=="ErrnoError")throw n;return-n.Pa}},q:function(t,e,r){try{e=e?T(D,e):"",e=Qt(t,e,!0);var n=Date.now(),o,a;if(r){var l=V[r>>2]+4294967296*I[r+4>>2],v=I[r+8>>2];v==1073741823?o=n:v==1073741822?o=null:o=1e3*l+v/1e6,r+=16,l=V[r>>2]+4294967296*I[r+4>>2],v=I[r+8>>2],v==1073741823?a=n:v==1073741822?a=null:a=1e3*l+v/1e6}else a=o=n;if((a??o)!==null){t=o;var O=ft(e,{$a:!0}).node;Ae(O.La.Ua)(O,{atime:t,mtime:a})}return 0}catch(k){if(typeof Q>"u"||k.name!=="ErrnoError")throw k;return-k.Pa}},m:()=>at(""),l:()=>{p=!1,He=0},A:function(t,e){t=-9007199254740992>t||9007199254740992<t?NaN:Number(t),t=new Date(1e3*t),I[e>>2]=t.getSeconds(),I[e+4>>2]=t.getMinutes(),I[e+8>>2]=t.getHours(),I[e+12>>2]=t.getDate(),I[e+16>>2]=t.getMonth(),I[e+20>>2]=t.getFullYear()-1900,I[e+24>>2]=t.getDay();var r=t.getFullYear();I[e+28>>2]=(r%4!==0||r%100===0&&r%400!==0?Gr:Vr)[t.getMonth()]+t.getDate()-1|0,I[e+36>>2]=-(60*t.getTimezoneOffset()),r=new Date(t.getFullYear(),6,1).getTimezoneOffset();var n=new Date(t.getFullYear(),0,1).getTimezoneOffset();I[e+32>>2]=(r!=n&&t.getTimezoneOffset()==Math.min(n,r))|0},y:function(t,e,r,n,o,a,l){o=-9007199254740992>o||9007199254740992<o?NaN:Number(o);try{if(isNaN(o))return 61;var v=lt(n);if((e&2)!==0&&(r&2)===0&&(v.flags&2097155)!==2)throw new m(2);if((v.flags&2097155)===1)throw new m(2);if(!v.Ma.ib)throw new m(43);if(!t)throw new m(28);var O=v.Ma.ib(v,t,o,e,r),k=O.Kb;return I[a>>2]=O.Ab,V[l>>2]=k,0}catch(Z){if(typeof Q>"u"||Z.name!=="ErrnoError")throw Z;return-Z.Pa}},z:function(t,e,r,n,o,a){a=-9007199254740992>a||9007199254740992<a?NaN:Number(a);try{var l=lt(o);if(r&2){if(r=a,(l.node.mode&61440)!==32768)throw new m(43);if(!(n&2)){var v=D.slice(t,t+e);l.Ma.jb&&l.Ma.jb(l,v,r,e,n)}}}catch(O){if(typeof Q>"u"||O.name!=="ErrnoError")throw O;return-O.Pa}},n:(t,e)=>{if(me[t]&&(clearTimeout(me[t].id),delete me[t]),!e)return 0;var r=setTimeout(()=>{delete me[t],Zr(()=>qr(t,performance.now()))},e);return me[t]={id:r,Xb:e},0},B:(t,e,r,n)=>{var o=new Date().getFullYear(),a=new Date(o,0,1).getTimezoneOffset();o=new Date(o,6,1).getTimezoneOffset(),V[t>>2]=60*Math.max(a,o),I[e>>2]=+(a!=o),e=l=>{var v=Math.abs(l);return`UTC${0<=l?"-":"+"}${String(Math.floor(v/60)).padStart(2,"0")}${String(v%60).padStart(2,"0")}`},t=e(a),e=e(o),o<a?(tt(t,D,r,17),tt(e,D,n,17)):(tt(t,D,n,17),tt(e,D,r,17))},d:()=>Date.now(),s:()=>2147483648,c:()=>performance.now(),o:t=>{var e=D.length;if(t>>>=0,2147483648<t)return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296);t:{n=(Math.min(2147483648,65536*Math.ceil(Math.max(t,n)/65536))-Mt.buffer.byteLength+65535)/65536|0;try{Mt.grow(n),ge();var o=1;break t}catch{}o=void 0}if(o)return!0}return!1},E:(t,e)=>{var r=0;return Mr().forEach((n,o)=>{var a=e+r;for(o=V[t+4*o>>2]=a,a=0;a<n.length;++a)J[o++]=n.charCodeAt(a);J[o]=0,r+=n.length+1}),0},F:(t,e)=>{var r=Mr();V[t>>2]=r.length;var n=0;return r.forEach(o=>n+=o.length+1),V[e>>2]=n,0},e:function(t){try{var e=lt(t);return Qe(e),0}catch(r){if(typeof Q>"u"||r.name!=="ErrnoError")throw r;return r.Pa}},p:function(t,e){try{var r=lt(t);return J[e]=r.tty?2:ht(r.mode)?3:(r.mode&61440)===40960?7:4,pt[e+2>>1]=0,ut[e+8>>3]=BigInt(0),ut[e+16>>3]=BigInt(0),0}catch(n){if(typeof Q>"u"||n.name!=="ErrnoError")throw n;return n.Pa}},w:function(t,e,r,n){try{t:{var o=lt(t);t=e;for(var a,l=e=0;l<r;l++){var v=V[t>>2],O=V[t+4>>2];t+=8;var k=gr(o,J,v,O,a);if(0>k){var Z=-1;break t}if(e+=k,k<O)break;typeof a<"u"&&(a+=k)}Z=e}return V[n>>2]=Z,0}catch(dt){if(typeof Q>"u"||dt.name!=="ErrnoError")throw dt;return dt.Pa}},D:function(t,e,r,n){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e);try{if(isNaN(e))return 61;var o=lt(t);return _r(o,e,r),ut[n>>3]=BigInt(o.position),o.ob&&e===0&&r===0&&(o.ob=null),0}catch(a){if(typeof Q>"u"||a.name!=="ErrnoError")throw a;return a.Pa}},I:function(t){try{var e=lt(t);return e.Ma?.fsync?e.Ma.fsync(e):0}catch(r){if(typeof Q>"u"||r.name!=="ErrnoError")throw r;return r.Pa}},t:function(t,e,r,n){try{t:{var o=lt(t);t=e;for(var a,l=e=0;l<r;l++){var v=V[t>>2],O=V[t+4>>2];t+=8;var k=vr(o,J,v,O,a);if(0>k){var Z=-1;break t}if(e+=k,k<O)break;typeof a<"u"&&(a+=k)}Z=e}return V[n>>2]=Z,0}catch(dt){if(typeof Q>"u"||dt.name!=="ErrnoError")throw dt;return dt.Pa}},k:xr},g;(async function(){function t(r){return g=r.exports,Mt=g.M,ge(),Lt=g.O,Rt--,i.monitorRunDependencies?.(Rt),Rt==0&&Wt&&(r=Wt,Wt=null,r()),g}Rt++,i.monitorRunDependencies?.(Rt);var e={a:Jr};return i.instantiateWasm?new Promise(r=>{i.instantiateWasm(e,(n,o)=>{t(n),r(n.exports)})}):(le??=i.locateFile?i.locateFile("sql-wasm.wasm",Y):Y+"sql-wasm.wasm",t((await Tt(e)).instance))})(),i._sqlite3_free=t=>(i._sqlite3_free=g.P)(t),i._sqlite3_value_text=t=>(i._sqlite3_value_text=g.Q)(t),i._sqlite3_prepare_v2=(t,e,r,n,o)=>(i._sqlite3_prepare_v2=g.R)(t,e,r,n,o),i._sqlite3_step=t=>(i._sqlite3_step=g.S)(t),i._sqlite3_reset=t=>(i._sqlite3_reset=g.T)(t),i._sqlite3_exec=(t,e,r,n,o)=>(i._sqlite3_exec=g.U)(t,e,r,n,o),i._sqlite3_finalize=t=>(i._sqlite3_finalize=g.V)(t),i._sqlite3_column_name=(t,e)=>(i._sqlite3_column_name=g.W)(t,e),i._sqlite3_column_text=(t,e)=>(i._sqlite3_column_text=g.X)(t,e),i._sqlite3_column_type=(t,e)=>(i._sqlite3_column_type=g.Y)(t,e),i._sqlite3_errmsg=t=>(i._sqlite3_errmsg=g.Z)(t),i._sqlite3_clear_bindings=t=>(i._sqlite3_clear_bindings=g._)(t),i._sqlite3_value_blob=t=>(i._sqlite3_value_blob=g.$)(t),i._sqlite3_value_bytes=t=>(i._sqlite3_value_bytes=g.aa)(t),i._sqlite3_value_double=t=>(i._sqlite3_value_double=g.ba)(t),i._sqlite3_value_int=t=>(i._sqlite3_value_int=g.ca)(t),i._sqlite3_value_type=t=>(i._sqlite3_value_type=g.da)(t),i._sqlite3_result_blob=(t,e,r,n)=>(i._sqlite3_result_blob=g.ea)(t,e,r,n),i._sqlite3_result_double=(t,e)=>(i._sqlite3_result_double=g.fa)(t,e),i._sqlite3_result_error=(t,e,r)=>(i._sqlite3_result_error=g.ga)(t,e,r),i._sqlite3_result_int=(t,e)=>(i._sqlite3_result_int=g.ha)(t,e),i._sqlite3_result_int64=(t,e)=>(i._sqlite3_result_int64=g.ia)(t,e),i._sqlite3_result_null=t=>(i._sqlite3_result_null=g.ja)(t),i._sqlite3_result_text=(t,e,r,n)=>(i._sqlite3_result_text=g.ka)(t,e,r,n),i._sqlite3_aggregate_context=(t,e)=>(i._sqlite3_aggregate_context=g.la)(t,e),i._sqlite3_column_count=t=>(i._sqlite3_column_count=g.ma)(t),i._sqlite3_data_count=t=>(i._sqlite3_data_count=g.na)(t),i._sqlite3_column_blob=(t,e)=>(i._sqlite3_column_blob=g.oa)(t,e),i._sqlite3_column_bytes=(t,e)=>(i._sqlite3_column_bytes=g.pa)(t,e),i._sqlite3_column_double=(t,e)=>(i._sqlite3_column_double=g.qa)(t,e),i._sqlite3_bind_blob=(t,e,r,n,o)=>(i._sqlite3_bind_blob=g.ra)(t,e,r,n,o),i._sqlite3_bind_double=(t,e,r)=>(i._sqlite3_bind_double=g.sa)(t,e,r),i._sqlite3_bind_int=(t,e,r)=>(i._sqlite3_bind_int=g.ta)(t,e,r),i._sqlite3_bind_text=(t,e,r,n,o)=>(i._sqlite3_bind_text=g.ua)(t,e,r,n,o),i._sqlite3_bind_parameter_index=(t,e)=>(i._sqlite3_bind_parameter_index=g.va)(t,e),i._sqlite3_sql=t=>(i._sqlite3_sql=g.wa)(t),i._sqlite3_normalized_sql=t=>(i._sqlite3_normalized_sql=g.xa)(t),i._sqlite3_changes=t=>(i._sqlite3_changes=g.ya)(t),i._sqlite3_close_v2=t=>(i._sqlite3_close_v2=g.za)(t),i._sqlite3_create_function_v2=(t,e,r,n,o,a,l,v,O)=>(i._sqlite3_create_function_v2=g.Aa)(t,e,r,n,o,a,l,v,O),i._sqlite3_update_hook=(t,e,r)=>(i._sqlite3_update_hook=g.Ba)(t,e,r),i._sqlite3_open=(t,e)=>(i._sqlite3_open=g.Ca)(t,e);var Je=i._malloc=t=>(Je=i._malloc=g.Da)(t),De=i._free=t=>(De=i._free=g.Ea)(t);i._RegisterExtensionFunctions=t=>(i._RegisterExtensionFunctions=g.Fa)(t);var Er=(t,e)=>(Er=g.Ga)(t,e),qr=(t,e)=>(qr=g.Ha)(t,e),be=t=>(be=g.Ia)(t),Bt=t=>(Bt=g.Ja)(t),we=()=>(we=g.Ka)();i.stackSave=()=>we(),i.stackRestore=t=>be(t),i.stackAlloc=t=>Bt(t),i.cwrap=(t,e,r,n)=>{var o=!r||r.every(a=>a==="number"||a==="boolean");return e!=="string"&&o&&!n?i["_"+t]:(...a)=>Kr(t,e,r,a)},i.addFunction=pe,i.removeFunction=Ft,i.UTF8ToString=K,i.ALLOC_NORMAL=Ce,i.allocate=Pe,i.allocateUTF8OnStack=Ze;function tr(){function t(){if(i.calledRun=!0,!St){if(!i.noFSInit&&!nt){var e,r;nt=!0,n??=i.stdin,e??=i.stdout,r??=i.stderr,n?It("stdin",n):Xe("/dev/tty","/dev/stdin"),e?It("stdout",null,e):Xe("/dev/tty","/dev/stdout"),r?It("stderr",null,r):Xe("/dev/tty1","/dev/stderr"),re("/dev/stdin",0),re("/dev/stdout",1),re("/dev/stderr",1)}if(g.N(),ct=!1,i.onRuntimeInitialized?.(),i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;){var n=i.postRun.shift();f.unshift(n)}xe(f)}}if(0<Rt)Wt=tr;else{if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)q();xe(_),0<Rt?Wt=tr:i.setStatus?(i.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>i.setStatus(""),1),t()},1)):t()}}if(i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();return tr(),N}),h)};c.exports=b,c.exports.default=b})(rr)),rr.exports}var zn=On();const Cn=Ln(zn),Pn="/eastern-front.db",Dn="/eastern-front.manifest.json",Nn="/sql-wasm.wasm",In="eastern-front-readside",ye="cache",Ir="db";let qt=null,Ie=null;function Fr(){return new Promise((c,d)=>{const h=indexedDB.open(In,1);h.onupgradeneeded=()=>h.result.createObjectStore(ye),h.onsuccess=()=>c(h.result),h.onerror=()=>d(h.error)})}async function Fn(){try{const c=await Fr();return new Promise(d=>{const b=c.transaction(ye,"readonly").objectStore(ye).get(Ir);b.onsuccess=()=>d(b.result||null),b.onerror=()=>d(null)})}catch{return null}}async function Bn(c,d){try{(await Fr()).transaction(ye,"readwrite").objectStore(ye).put({data:c,hash:d},Ir)}catch{}}async function Un(){return Ie||(Ie=(async()=>{const c=await Cn({locateFile:()=>Nn});let d=null;try{const B=await fetch(Dn);B.ok&&(d=await B.json())}catch{}const h=await Fn();if(h&&d&&h.hash===d.db_hash)return qt=new c.Database(new Uint8Array(h.data)),qt;const b=await fetch(Pn);if(!b.ok)throw new Error(`Failed to fetch database: ${b.status}`);const w=await b.arrayBuffer(),M=new Uint8Array(w);return qt=new c.Database(M),d&&Bn(w,d.db_hash),qt})(),Ie)}function Wn(){const c=qt.prepare("SELECT * FROM dates ORDER BY date_idx"),d=[];for(;c.step();)d.push(c.getAsObject());return c.free(),d}function $n(){const c=qt.prepare("SELECT * FROM dates WHERE is_keyframe = 1 ORDER BY date_idx"),d=[];for(;c.step();)d.push(c.getAsObject());return c.free(),d}function Yn(c,d){const h=qt.prepare(`
    SELECT rows, cols, lat_min, lat_max, lon_min, lon_max, field_data
    FROM field_tiles
    WHERE date_idx = ? AND level = ? AND zone_id = 'global'
    ORDER BY lat_max DESC, lon_min ASC
  `);h.bind([c,d]);const b=[];for(;h.step();){const X=h.getAsObject(),U=X.field_data;X.field_data=new Float32Array(U.buffer.slice(U.byteOffset,U.byteOffset+U.byteLength)),b.push(X)}if(h.free(),b.length===0)return null;if(b.length===1)return b[0];const w=[];let M=null;for(const X of b)!M||X.lat_min!==M[0].lat_min?(M=[X],w.push(M)):M.push(X);const B=w.reduce((X,U)=>X+U[0].rows,0),N=w[0].reduce((X,U)=>X+U.cols,0),H=new Float32Array(B*N);let i=0;for(const X of w){const U=X[0].rows;for(let et=0;et<U;et++){let xt=0;for(const st of X){const mt=et*st.cols;for(let Y=0;Y<st.cols;Y++)H[(i+et)*N+xt+Y]=st.field_data[mt+Y];xt+=st.cols}}i+=U}return{rows:B,cols:N,lat_min:w[w.length-1][0].lat_min,lat_max:w[0][0].lat_max,lon_min:w[0][0].lon_min,lon_max:w[0][w[0].length-1].lon_max,field_data:H}}function Xn(c,d){const h=qt.prepare(`
    SELECT zone_id, segments, seg_count FROM contours
    WHERE date_idx = ? AND level = ?
  `);h.bind([c,d]);const b=[];for(;h.step();){const w=h.getAsObject(),M=w.segments;w.segments=new Float32Array(M.buffer.slice(M.byteOffset,M.byteOffset+M.byteLength)),b.push(w)}return h.free(),b}function Qn(){const c=qt.prepare("SELECT city_id, name, lat, lon, is_major, start_control FROM cities"),d=[];for(;c.step();)d.push(c.getAsObject());return c.free(),d}function Hn(c,d){const h=qt.prepare("SELECT data FROM city_states WHERE date_idx = ?");if(h.bind([c]),!h.step())return h.free(),{};const b=h.getAsObject();h.free();const w=b.data,M={},B=new Uint8Array(w.buffer,w.byteOffset,w.byteLength),N=new DataView(B.buffer,B.byteOffset,B.byteLength);for(let H=0;H<d.length;H++){const i=H*5;if(i+5>B.length)break;const X=B[i],U=N.getFloat32(i+1,!0);M[d[H].city_id]={control:X===1?"axis":"soviet",strength:U}}return M}class ne{constructor(d=200){this.maxEntries=d,this.cache=new Map}static key(d,h,b){return`${d}:${h}:${b}`}get(d,h,b){const w=ne.key(d,h,b);if(!this.cache.has(w))return null;const M=this.cache.get(w);return this.cache.delete(w),this.cache.set(w,M),M}set(d,h,b,w){const M=ne.key(d,h,b);for(this.cache.has(M)&&this.cache.delete(M),this.cache.set(M,w);this.cache.size>this.maxEntries;){const B=this.cache.keys().next().value;this.cache.delete(B)}}has(d,h,b){return this.cache.has(ne.key(d,h,b))}clear(){this.cache.clear()}get size(){return this.cache.size}}function Vn(c,d,h){const b=new Float32Array(c.length);for(let w=0;w<c.length;w++)b[w]=c[w]+(d[w]-c[w])*h;return b}const nr={centerLat:52.5,centerLon:31,zoom:6},Br=4,Ur=9,Be=256;function oe(c,d){const h=Math.pow(2,d),b=c*Math.PI/180;return(1-Math.log(Math.tan(b)+1/Math.cos(b))/Math.PI)/2*h*Be}function ie(c,d){const h=Math.pow(2,d);return(c+180)/360*h*Be}function ar(c,d){const h=Math.pow(2,d),b=Math.PI*(1-2*c/(h*Be));return Math.atan(Math.sinh(b))*(180/Math.PI)}function lr(c,d){const h=Math.pow(2,d);return c/(h*Be)*360-180}function Gt(c,d,h,b,w){const M=ie(h.centerLon,h.zoom),B=oe(h.centerLat,h.zoom),N=ie(d,h.zoom)-M+b/2,H=oe(c,h.zoom)-B+w/2;return[N,H]}function sr(c,d,h,b,w){const M=ie(h.centerLon,h.zoom),B=oe(h.centerLat,h.zoom),N=c-b/2+M,H=d-w/2+B;return{lat:ar(H,h.zoom),lon:lr(N,h.zoom)}}function Wr(c,d,h){const b=sr(0,0,c,d,h),w=sr(d,h,c,d,h);return{latMin:Math.min(b.lat,w.lat),latMax:Math.max(b.lat,w.lat),lonMin:Math.min(b.lon,w.lon),lonMax:Math.max(b.lon,w.lon)}}function Gn(c,d,h){return`https://basemaps.cartocdn.com/dark_nolabels/${c}/${d}/${h}.png`}function Zn(c,d,h){const b=Math.floor(c.zoom),w=1<<b,M=Wr(c,d,h),B=Math.max(0,Math.floor((M.lonMin+180)/360*w)),N=Math.min(w-1,Math.floor((M.lonMax+180)/360*w)),H=Math.max(0,Math.floor((1-Math.log(Math.tan(M.latMax*Math.PI/180)+1/Math.cos(M.latMax*Math.PI/180))/Math.PI)/2*w)),i=Math.min(w-1,Math.floor((1-Math.log(Math.tan(M.latMin*Math.PI/180)+1/Math.cos(M.latMin*Math.PI/180))/Math.PI)/2*w)),X=[];for(let U=H;U<=i;U++)for(let et=B;et<=N;et++)X.push({z:b,x:et,y:U,url:Gn(b,et,U)});return X}function $r(c){return{centerLat:Math.max(-85,Math.min(85,c.centerLat)),centerLon:Math.max(-180,Math.min(180,c.centerLon)),zoom:Math.max(Br,Math.min(Ur,c.zoom))}}function or(c,d,h,b,w,M){const B=sr(h,b,c,w,M),N=Math.max(Br,Math.min(Ur,c.zoom+d)),H=ie(B.lon,N)-(h-w/2),i=oe(B.lat,N)-(b-M/2);return $r({centerLat:ar(i,N),centerLon:lr(H,N),zoom:N})}function Nr(c,d,h,b,w){const M=ie(c.centerLon,c.zoom),B=oe(c.centerLat,c.zoom);return $r({centerLat:ar(B-h,c.zoom),centerLon:lr(M-d,c.zoom),zoom:c.zoom})}const j={bg:"#08090c",mapBg:"#0d1117",text:"#c8cad0",titleColor:"#888",subtitleColor:"#555",periodLabel:"#e0dcd4",periodSub:"#8a8580",tileFilter:"brightness(0.95) saturate(0.4) contrast(1.1)",frontLine:{glow:[[14,"rgba(255,200,40,0.12)"],[5,"rgba(255,200,40,0.28)"],[2,"rgba(255,220,60,0.9)"]]},city:{axis:{dot:"rgba(140,155,175,0.85)",label:"rgba(140,155,175,0.7)"},soviet:{dot:"rgba(210,170,170,0.85)",label:"rgba(200,180,180,0.65)"},majorDot:"rgba(255,255,255,0.9)",majorLabel:"rgba(255,255,255,0.92)",majorRing:"rgba(255,255,255,0.6)",majorGlow:"rgba(255,255,255,0.06)",shadow:"rgba(0,0,0,0.7)"},timeline:{active:"#c4913a",inactive:"#444",bg:"#1a1a1a",track:"#222",gradient:["#6b4a2a","#c4913a"],glow:"rgba(196,145,58,0.4)"},legend:{axis:{label:"Axis-controlled",bg:"rgba(50,55,65,0.7)",border:"#444"},soviet:{label:"Soviet-controlled",bg:"rgba(160,25,25,0.5)",border:"#663030"},frontLine:{label:"Front line",bg:"rgba(255,220,60,0.85)"}},attribution:"#333"};function Kn(c,d,h){return c+(d-c)*h}const ir=new Map;let Fe=null;function Jn(c){if(ir.has(c))return ir.get(c);const d=new Image;d.crossOrigin="anonymous",d.src=c;const h={img:d,loaded:!1};return d.onload=()=>{h.loaded=!0,Fe&&Fe()},ir.set(c,h),h}function ro(){const c=z.useRef(null),[d,h]=z.useState(!0),[b,w]=z.useState(null),[M,B]=z.useState(0),N=z.useRef(0),[H,i]=z.useState(null),X=z.useRef(null),[U,et]=z.useState(()=>({w:typeof window<"u"?window.innerWidth:800,h:typeof window<"u"?window.innerHeight:600})),xt=z.useRef(null),[st,mt]=z.useState(nr),Y=z.useRef(nr),wt=z.useRef([]),kt=z.useRef([]),Ut=z.useRef([]),_e=z.useRef(new ne(300));z.useRef(new ne(200));const yt=z.useRef(new Map),jt=z.useRef(null),Mt=z.useRef({queryGlobalTile:Yn,queryAllContours:Xn,queryCityStates:Hn}),[St]=z.useState(()=>new URLSearchParams(window.location.search).get("headless")==="true"),[Zt]=z.useState(()=>{const f=new URLSearchParams(window.location.search).get("cities");return f?new Set(f.split(",").map(_=>_.trim().toLowerCase())):null}),[J,D]=z.useState(0);z.useEffect(()=>(Fe=()=>D(f=>f+1),()=>{Fe=null}),[]);const pt=z.useRef(null);z.useEffect(()=>{(async()=>{try{const f=new URLSearchParams(window.location.search),_=f.get("mode")==="live";if(_){const x=await Cr(()=>import("./live-provider-iPc-Gwsg.js"),__vite__mapDeps([0,1,2]));await x.initLive(),wt.current=x.queryDates(),kt.current=x.queryKeyframes(),Ut.current=x.queryAllCities(),Mt.current={queryGlobalTile:x.queryGlobalTile,queryAllContours:x.queryAllContours,queryCityStates:x.queryCityStates}}else await Un(),wt.current=Wn(),kt.current=$n(),Ut.current=Qn();const q=f.get("date"),C=f.get("zoom"),p=f.get("lat"),G=f.get("lon");if(q){let x;if(_){const T=await Cr(()=>import("./live-provider-iPc-Gwsg.js"),__vite__mapDeps([0,1,2]));x=T.ensureDate(q),wt.current=T.queryDates()}else{const T=wt.current;if(x=T.findIndex(K=>K.date_iso===q),x<0){for(let K=T.length-1;K>=0;K--)if(T[K].date_iso<=q){x=K;break}}}x>=0&&(N.current=x,B(x))}if(C||p||G){const x={...nr};C&&(x.zoom=parseFloat(C)),p&&(x.centerLat=parseFloat(p)),G&&(x.centerLon=parseFloat(G)),Y.current=x,mt(x)}h(!1)}catch(f){console.error("Failed to load:",f),w(f.message),h(!1)}})()},[]),z.useEffect(()=>{const f=new ResizeObserver(_=>{for(const q of _)et({w:q.contentRect.width,h:q.contentRect.height})});return xt.current&&f.observe(xt.current),()=>f.disconnect()},[d]),z.useEffect(()=>{if(H===null)return;const f=N.current,_=H,q=Math.abs(_-f)*400+200,C=performance.now();function p(G){const x=Math.min((G-C)/q,1),T=x<.5?2*x*x:1-Math.pow(-2*x+2,2)/2,K=Kn(f,_,T);N.current=K,B(K),x<1?X.current=requestAnimationFrame(p):i(null)}return X.current=requestAnimationFrame(p),()=>cancelAnimationFrame(X.current)},[H]);const I=z.useCallback(f=>{f.preventDefault();const _=c.current.getBoundingClientRect(),q=f.clientX-_.left,C=f.clientY-_.top,p=_.width,G=_.height,x=f.ctrlKey?.01:.002,T=-f.deltaY*x,K=or(Y.current,T,q,C,p,G);Y.current=K,mt(K)},[]),V=z.useCallback(f=>{f.button===0&&(pt.current={x:f.clientX,y:f.clientY})},[]),se=z.useCallback(f=>{if(!pt.current)return;const _=f.clientX-pt.current.x,q=f.clientY-pt.current.y;pt.current={x:f.clientX,y:f.clientY};const C=c.current.getBoundingClientRect(),p=Nr(Y.current,_,q,C.width,C.height);Y.current=p,mt(p)},[]),ut=z.useCallback(()=>{pt.current=null},[]),ae=z.useCallback(f=>{const _=c.current.getBoundingClientRect(),q=f.clientX-_.left,C=f.clientY-_.top,p=or(Y.current,1,q,C,_.width,_.height);Y.current=p,mt(p)},[]),rt=z.useRef(null),ge=z.useCallback(f=>{if(f.touches.length===1)rt.current={type:"pan",x:f.touches[0].clientX,y:f.touches[0].clientY};else if(f.touches.length===2){const _=f.touches[1].clientX-f.touches[0].clientX,q=f.touches[1].clientY-f.touches[0].clientY;rt.current={type:"pinch",dist:Math.sqrt(_*_+q*q),cx:(f.touches[0].clientX+f.touches[1].clientX)/2,cy:(f.touches[0].clientY+f.touches[1].clientY)/2}}},[]),Rt=z.useCallback(f=>{if(f.preventDefault(),!!rt.current){if(rt.current.type==="pan"&&f.touches.length===1){const _=f.touches[0].clientX-rt.current.x,q=f.touches[0].clientY-rt.current.y;rt.current={type:"pan",x:f.touches[0].clientX,y:f.touches[0].clientY};const C=c.current.getBoundingClientRect(),p=Nr(Y.current,_,q,C.width,C.height);Y.current=p,mt(p)}else if(rt.current.type==="pinch"&&f.touches.length===2){const _=f.touches[1].clientX-f.touches[0].clientX,q=f.touches[1].clientY-f.touches[0].clientY,C=Math.sqrt(_*_+q*q),p=(C-rt.current.dist)*.01,G=c.current.getBoundingClientRect(),x=(f.touches[0].clientX+f.touches[1].clientX)/2-G.left,T=(f.touches[0].clientY+f.touches[1].clientY)/2-G.top;rt.current.dist=C;const K=or(Y.current,p,x,T,G.width,G.height);Y.current=K,mt(K)}}},[]),Wt=z.useCallback(()=>{rt.current=null},[]);z.useEffect(()=>{if(d||b)return;const f=c.current;if(!f)return;const _=U.w,q=St?U.h:U.h-160;if(_<=0||q<=0)return;window.__renderComplete=!1,window.__debugView={zoom:st.zoom,centerLat:st.centerLat,centerLon:st.centerLon,canvasW:_,canvasH:q,slider:M,dateCount:wt.current.length,dateAtSlider:wt.current[Math.floor(M)]?.date_iso};const C=window.devicePixelRatio||1;f.width=_*C,f.height=q*C;const p=f.getContext("2d");p.setTransform(C,0,0,C,0,0),p.clearRect(0,0,_,q);const G=wt.current;if(G.length===0)return;const x=st,T=Zn(x,_,q),K=Math.floor(x.zoom);let ue=0;p.save(),p.filter=j.tileFilter;for(const S of T){const A=Jn(S.url);if(!A.loaded)continue;ue++;const F=256*Math.pow(2,x.zoom-K),$=S.x*F,nt=S.y*F,ct=ie(x.centerLon,x.zoom),ot=oe(x.centerLat,x.zoom),m=$-ct+_/2,At=nt-ot+q/2;p.drawImage(A.img,m,At,F,F)}p.filter="none",p.restore(),window.__baseTilesTotal=T.length,window.__baseTilesLoaded=ue,jt.current||(jt.current=An.conflict.map(S=>S.map(A=>A.map(([F,$])=>[$,F])))),p.save(),p.beginPath();for(const S of jt.current)for(const A of S){if(A.length<3)continue;const[F,$]=Gt(A[0][0],A[0][1],x,_,q);p.moveTo(F,$);for(let nt=1;nt<A.length;nt++){const[ct,ot]=Gt(A[nt][0],A[nt][1],x,_,q);p.lineTo(ct,ot)}p.closePath()}p.clip();const Kt=M,Jt=Math.min(Math.floor(Kt),G.length-2),Ot=Kt-Jt,ce=Jt,te=Math.min(Jt+1,G.length-1),Me=_e.current,zt=Wr(x,_,q);function Ct(S,A){const F=Me.get(S,A,"global");if(F)return F;const $=Mt.current.queryGlobalTile(S,A);return $&&Me.set(S,A,"global",$),$}const tt=Ct(ce,1),fe=Ct(te,1);if(p.imageSmoothingEnabled=!0,p.imageSmoothingQuality="high",tt&&fe){const S=Vn(tt.field_data,fe.field_data,Ot),A=tt.rows,F=tt.cols,$=document.createElement("canvas");$.width=F,$.height=A;const nt=$.getContext("2d"),ct=nt.createImageData(F,A),ot=ct.data;for(let Pt=0;Pt<A;Pt++)for(let Dt=0;Dt<F;Dt++){const Nt=S[Pt*F+Dt];if(Nt===0)continue;const it=(Pt*F+Dt)*4;Nt>0?(ot[it]=50,ot[it+1]=55,ot[it+2]=65,ot[it+3]=Math.min(166,Nt*89|0)):(ot[it]=160,ot[it+1]=25,ot[it+2]=25,ot[it+3]=Math.min(140,-Nt*64|0))}nt.putImageData(ct,0,0);const[m,At]=Gt(tt.lat_max,tt.lon_min,x,_,q),[We,ft]=Gt(tt.lat_min,tt.lon_max,x,_,q);p.drawImage($,m,At,We-m,ft-At)}const Ee=Mt.current.queryAllContours(ce,1),qe=Mt.current.queryAllContours(te,1);function Se(S){p.beginPath();for(let A=0;A<S.length;A+=4){const[F,$]=Gt(S[A],S[A+1],x,_,q),[nt,ct]=Gt(S[A+2],S[A+3],x,_,q);p.moveTo(F,$),p.lineTo(nt,ct)}p.stroke()}p.save(),p.lineCap="round";const Ue=Ot<.5?Ee:qe;for(const S of Ue){for(const[A,F]of j.frontLine.glow)p.strokeStyle=F,p.lineWidth=A,Se(S.segments);p.strokeStyle="rgba(255,220,60,0.9)",p.lineWidth=1.5,Se(S.segments)}p.restore(),p.restore();const Re=Ut.current,R=Ot<.5?ce:te;let Xt=yt.current.get(R);if(!Xt&&(Xt=Mt.current.queryCityStates(R,Re),yt.current.set(R,Xt),yt.current.size>30)){const S=yt.current.keys().next().value;yt.current.delete(S)}const he=x.zoom>=5.5;for(const S of Re){if(!he&&!S.is_major||S.lat<zt.latMin-1||S.lat>zt.latMax+1||S.lon<zt.lonMin-1||S.lon>zt.lonMax+1)continue;const[A,F]=Gt(S.lat,S.lon,x,_,q);if(A<-20||A>_+20||F<-20||F>q+20)continue;const $=Xt[S.city_id],nt=$?$.control:S.start_control,ct=j.city[nt]||j.city.soviet;if(S.is_major&&(p.beginPath(),p.arc(A,F,10,0,Math.PI*2),p.fillStyle=j.city.majorGlow,p.fill(),p.beginPath(),p.arc(A,F,5,0,Math.PI*2),p.strokeStyle=j.city.majorRing,p.lineWidth=1.5,p.stroke()),p.beginPath(),p.arc(A,F,S.is_major?3:2,0,Math.PI*2),p.fillStyle=S.is_major?j.city.majorDot:ct.dot,p.fill(),(!Zt||Zt.has(S.name.toLowerCase()))&&(S.is_major||x.zoom>=6)){p.save(),p.font=S.is_major?"bold 13px Georgia, serif":"10px Georgia, serif",p.textAlign="left",p.textBaseline="middle";const At=S.is_major?12:7;p.fillStyle=j.city.shadow,p.fillText(S.name,A+At+1,F+1),p.fillStyle=S.is_major?j.city.majorLabel:ct.label,p.fillText(S.name,A+At,F),p.restore()}}window.__renderComplete=!0},[d,b,M,U,st,St,J]),z.useEffect(()=>{const f=c.current;if(f)return f.addEventListener("wheel",I,{passive:!1}),()=>f.removeEventListener("wheel",I)},[I,d]);const at=wt.current,le=kt.current,$t=Math.max(at.length-1,1),ve=Math.round(M),Tt=at[Math.min(ve,at.length-1)],Yt=(()=>{if(!Tt)return{label:"Loading...",sublabel:""};if(Tt.is_keyframe&&Tt.label)return Tt;for(let f=Math.min(ve,at.length-1);f>=0;f--)if(at[f].is_keyframe&&at[f].label)return at[f];return{label:"",sublabel:""}})();if(d)return P.jsx("div",{style:{width:"100%",height:"100vh",background:j.bg,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"Georgia, serif",color:j.text},children:P.jsxs("div",{style:{textAlign:"center"},children:[P.jsx("div",{style:{fontSize:16,letterSpacing:4,textTransform:"uppercase",color:j.titleColor},children:"Loading Database..."}),P.jsx("div",{style:{fontSize:12,color:j.subtitleColor,marginTop:8},children:"Downloading pre-computed field data"})]})});if(b)return P.jsx("div",{style:{width:"100%",height:"100vh",background:j.bg,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"Georgia, serif",color:"#c44"},children:P.jsxs("div",{style:{textAlign:"center"},children:[P.jsx("div",{style:{fontSize:16},children:"Failed to load database"}),P.jsx("div",{style:{fontSize:12,color:"#888",marginTop:8},children:b})]})});const xe=St?U.h:U.h-160;return St?P.jsx("div",{ref:xt,style:{width:"100%",height:"100vh",background:j.bg,overflow:"hidden",position:"relative"},children:P.jsx("canvas",{ref:c,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})}):P.jsxs("div",{ref:xt,style:{width:"100%",height:"100vh",background:j.bg,display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"Georgia, 'Times New Roman', serif",color:j.text,overflow:"hidden",position:"relative"},children:[P.jsxs("div",{style:{width:"100%",padding:"12px 20px 6px",textAlign:"center",zIndex:3,background:`linear-gradient(to bottom, ${j.bg} 60%, transparent)`},children:[P.jsx("h1",{style:{margin:0,fontSize:16,fontWeight:400,letterSpacing:6,textTransform:"uppercase",color:j.titleColor},children:"Eastern Front 19411945"}),P.jsxs("div",{style:{fontSize:11,color:j.subtitleColor,marginTop:2,letterSpacing:3},children:["Interactive Tiled Renderer  Zoom: ",st.zoom.toFixed(1)]})]}),P.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",minHeight:0},children:P.jsx("div",{style:{position:"relative",width:U.w,height:Math.max(xe,200),overflow:"hidden",borderRadius:2,background:j.mapBg},children:P.jsx("canvas",{ref:c,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",cursor:pt.current?"grabbing":"grab"},onMouseDown:V,onMouseMove:se,onMouseUp:ut,onMouseLeave:ut,onDoubleClick:ae,onTouchStart:ge,onTouchMove:Rt,onTouchEnd:Wt})})}),P.jsxs("div",{style:{width:"100%",maxWidth:900,padding:"10px 24px 18px",zIndex:2},children:[P.jsxs("div",{style:{textAlign:"center",marginBottom:8},children:[P.jsx("div",{style:{fontSize:20,fontWeight:"bold",color:j.periodLabel,transition:"all 0.3s"},children:Yt.label}),P.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,marginTop:2},children:[P.jsx("div",{style:{fontSize:13,color:j.timeline.active,fontFamily:"monospace",letterSpacing:1},children:Tt?Tt.date_iso:""}),Yt.sublabel&&P.jsx("div",{style:{fontSize:12,color:j.periodSub,fontStyle:"italic"},children:Yt.sublabel})]})]}),P.jsxs("div",{style:{position:"relative",padding:"0 6px"},children:[P.jsx("div",{style:{position:"relative",height:20,marginBottom:2},children:le.map(f=>{const _=f.date_idx/$t*100,q=Math.abs(M-f.date_idx)<3;return P.jsx("button",{onClick:()=>i(f.date_idx),style:{position:"absolute",left:`${_}%`,top:"50%",transform:"translate(-50%, -50%)",width:q?10:6,height:q?10:6,borderRadius:"50%",border:`1.5px solid ${q?j.timeline.active:j.timeline.inactive}`,background:q?j.timeline.active:j.timeline.bg,cursor:"pointer",padding:0,transition:"all 0.2s",boxShadow:q?`0 0 6px ${j.timeline.glow}`:"none"},title:`${f.label} (${f.date_iso})`},f.date_iso)})}),P.jsx("input",{type:"range",min:0,max:$t,step:.1,value:M,onChange:f=>{i(null);const _=parseFloat(f.target.value);N.current=_,B(_)},style:{width:"100%",height:4,appearance:"none",WebkitAppearance:"none",background:`linear-gradient(90deg, ${j.timeline.gradient[0]} 0%, ${j.timeline.gradient[1]} ${M/$t*100}%, ${j.timeline.track} ${M/$t*100}%, ${j.timeline.track} 100%)`,borderRadius:2,outline:"none",cursor:"pointer"}}),P.jsx("div",{style:{position:"relative",height:14,marginTop:4},children:["1941","1942","1943","1944","1945"].map(f=>{const _=at.find(C=>C.date_iso.startsWith(f));if(!_)return null;const q=_.date_idx/$t*100;return P.jsx("div",{onClick:()=>i(_.date_idx),style:{position:"absolute",left:`${q}%`,transform:"translateX(-50%)",fontSize:10,color:j.timeline.inactive,cursor:"pointer",letterSpacing:1},children:f},f)})})]}),P.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,marginTop:8,fontSize:10,color:"#666",flexWrap:"wrap"},children:[[j.legend.axis,j.legend.soviet].map(f=>P.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[P.jsx("div",{style:{width:14,height:10,background:f.bg,border:`1px solid ${f.border}`,borderRadius:2}}),f.label]},f.label)),P.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[P.jsx("div",{style:{width:14,height:2,background:j.legend.frontLine.bg,borderRadius:1}}),j.legend.frontLine.label]})]})]}),P.jsx("div",{style:{position:"absolute",bottom:2,right:8,fontSize:8,color:j.attribution},children:"Map tiles by CARTO  Data: Eastern Front CQRS Read-Side"})]})}export{ro as default};
